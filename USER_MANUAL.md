# 出席管理システム - 使用マニュアル

## 目次

- [概要](#概要)
- [システム構成](#システム構成)
- [起動方法](#起動方法)
- [イベントの作成](#イベントの作成)
- [出席登録](#出席登録)
- [モニター画面](#モニター画面)
- [データのエクスポート・インポート](#データのエクスポートインポート)
- [トラブルシューティング](#トラブルシューティング)

---

## 概要

このシステムは、イベントや授業の出席管理を効率的に行うためのアプリケーションです。

### 主な機能

- ✅ イベントの作成と管理
- ✅ リアルタイム出席登録
- ✅ 複数デバイスからの同時アクセス対応
- ✅ 当日参加者の登録
- ✅ 出席状況のリアルタイムモニタリング
- ✅ データのエクスポート（Excel、CSV、JSON）
- ✅ 過去イベントのインポート機能

---

## システム構成

### アーキテクチャ

- **デスクトップアプリ（Tauri）**: サーバー管理とモニター機能
- **Web ベース出席登録**: ブラウザから出席登録
- **リアルタイム同期**: Socket.IO による双方向通信

### 動作環境

- **サーバー**: Windows/Mac/Linux（Tauri アプリケーション）
- **クライアント**: 任意の Web ブラウザ（Chrome、Safari、Edge 等）
- **ネットワーク**: サーバーとクライアントが同じネットワークに接続

---

## 起動方法

### 1. アプリケーションの起動

デスクトップアプリを起動すると、ホーム画面が表示されます。

<!-- 画像: ホーム画面のスクリーンショット -->

![ホーム画面](./images/home_screen.png)

> **挿入する画像**: ホーム画面全体。「新規イベントを作成」「ファイルからインポート」の 2 つのボタンが表示されている画面

### 2. 内部サーバーの自動起動

初回のイベント作成時、またはインポート時に内部サーバー（Socket.IO サーバー）が自動的に起動します。

---

## イベントの作成

### 方法 1: 新規作成

#### ステップ 1: イベント基本情報の入力

1. ホーム画面で「新規イベントを作成」をクリック
2. イベント名とイベント情報を入力

<!-- 画像: イベント情報入力画面 -->

![イベント情報入力](./images/event_info_input.png)

> **挿入する画像**: イベント名とイベント情報の入力フォーム画面

#### ステップ 2: 参加者リストの登録

参加者を登録する方法は 3 つあります：

##### A. 手動入力

- 学籍番号を 1 つずつ入力
- Enter キーで追加

##### B. Excel ファイルからインポート

1. 「Excel ファイルからインポート」をクリック
2. `.xlsx`ファイルを選択
3. A 列に学籍番号が記載されているファイルを使用

<!-- 画像: Excelインポート画面 -->

![Excelインポート](./images/excel_import.png)

> **挿入する画像**: Excel ファイルをドラッグ&ドロップしている画面、またはファイル選択ダイアログ

##### C. JSON ファイルからインポート

- 過去のイベントデータを再利用
- 詳細は「[データのインポート](#データのインポート)」を参照

#### ステップ 3: 設定の選択

<!-- 画像: イベント設定画面 -->

![イベント設定](./images/event_settings.png)

> **挿入する画像**: 4 つのトグルスイッチ（当日参加を許可、自動で当日参加登録、総会モード、リストなしモード）が表示されている画面

##### 当日参加を許可

- **ON**: 事前登録されていない参加者も当日登録可能
- **OFF**: 事前登録者のみ出席可能

##### 自動で当日参加登録

- **ON**: 事前登録にない学籍番号が入力された場合、自動的に当日参加者として登録
- **OFF**: 事前登録にない学籍番号は拒否される
- ⚠️ 「当日参加を許可」が OFF の場合は使用不可

##### 総会モード

- **ON**: 出席者数ではなく「定足数」と「委任状」を表示
- **OFF**: 通常の出席管理モード

##### リストなしモード

- **ON**: 参加者リストを表示せず、当日参加者のみを管理
- **OFF**: 通常モード（参加者リスト表示）

#### ステップ 4: 確認と登録

1. 入力内容を確認
2. 「イベントを登録」をクリック
3. 完了画面が表示される

<!-- 画像: イベント登録完了画面 -->

![登録完了](./images/event_complete.png)

> **挿入する画像**: イベント登録完了画面。UUID と出席登録 URL が表示され、「モニターページを開く」「ホームに戻る」のボタンがある画面

---

## 出席登録

### クライアント側（出席登録ページ）

#### 1. 出席登録ページへのアクセス

**方法 A: モニターページから開く**

1. モニターページの「出席登録ページ」ボタンをクリック
2. 新しいブラウザウィンドウで出席登録ページが開く

**方法 B: URL を直接入力**

```
http://[サーバーIP]:50080/attendance.html?uuid=[イベントUUID]&server=[サーバーIP]:50345
```

<!-- 画像: 出席登録ページ全体 -->

![出席登録ページ](./images/attendance_page.png)

> **挿入する画像**: 出席登録ページ全体。左側に学籍番号入力フォームと統計情報、右側に出席者リスト表示

#### 2. 出席の登録

1. 学籍番号を入力
2. Enter キーまたは「登録」ボタンをクリック
3. 登録結果が表示される

##### 成功時の動作

- ✅ 緑色のフラッシュ
- ✅ 出席者リストに反映
- ✅ 統計情報が更新

##### エラー時の動作

- ❌ 赤色のアラート表示
- ❌ エラーメッセージ（「登録されていません」等）

<!-- 画像: 出席登録の成功例 -->

![出席登録成功](./images/attendance_success.png)

> **挿入する画像**: 学籍番号を入力して登録成功した直後の画面。リストに緑色のハイライトが表示されている様子

#### 3. 接続状態の確認

画面右上に接続状態インジケーターが表示されます：

- 🟢 **接続済み**: 正常に動作中
- 🟡 **接続中...**: サーバーに接続を試みています
- 🔴 **切断**: サーバーとの接続が切断されています

<!-- 画像: 接続状態インジケーター -->

![接続状態](./images/connection_status.png)

> **挿入する画像**: ヘッダー右上の接続状態表示（3 つの状態を並べて表示）

#### 4. メニュー機能

画面右上のメニューアイコン（⚙️）をクリックすると、以下の機能にアクセスできます：

##### イベント情報

- イベント名、UUID、出席登録 URL 等を確認

##### 設定

- 当日参加許可の有効/無効を切り替え
- 自動登録の有効/無効を切り替え
- ⚠️ 変更は全クライアントにリアルタイム同期

<!-- 画像: メニュードロワー -->

![メニュー](./images/menu_drawer.png)

> **挿入する画像**: 右側から開くメニュードロワー。イベント情報、設定、ダウンロードのセクションが表示されている画面

##### データのダウンロード

**Excel 形式**

- 統計情報シート
- 出席者リストシート
- 当日参加者シート

**CSV 形式**

- UTF-8（BOM 付き）
- カテゴリ列で「事前登録」「当日参加」を区別

**JSON 形式**

- イベントデータの完全なエクスポート
- 再インポート可能

<!-- 画像: ダウンロードタブ -->

![ダウンロードタブ](./images/download_tabs.png)

> **挿入する画像**: メニュー内のダウンロードセクション。Excel、CSV、JSON の 3 つのタブが表示されている画面

---

## モニター画面

### 概要

モニター画面では、出席状況をリアルタイムで監視できます。

<!-- 画像: モニター画面全体 -->

![モニター画面](./images/monitor_page.png)

> **挿入する画像**: モニターページ全体。左側に統計カード（出席者数、出席率、当日参加者数、合計参加者数）、右側に出席者リスト

### 統計カード

#### 出席者数カード

- 事前登録者からの出席人数
- 分母は事前登録者の総数

#### 出席率カード

- パーセンテージ表示
- プログレスバー付き

#### 当日参加者数カード

- 当日登録された参加者数
- 「当日参加を許可」が ON の場合のみ表示

#### 合計参加者数カード

- 出席者 + 当日参加者の合計
- グラデーション背景

<!-- 画像: 統計カードのアニメーション -->

![統計カード](./images/stats_cards.png)

> **挿入する画像**: 4 つの統計カードがアニメーションで表示されている様子（可能なら GIF アニメーション）

### 出席者リスト

#### 通常モード

- 事前登録者全員を表示
- 出席済みは緑色のバッジ「出席」
- 未出席は灰色のバッジ「未出席」

#### 総会モード

- 出席済みは「出席」
- 未出席は「委任状」

#### リストなしモード

- 当日参加者のみを表示
- 番号付きリスト

<!-- 画像: 出席者リストの3つのモード -->

![リスト表示モード](./images/list_modes.png)

> **挿入する画像**: 通常モード、総会モード、リストなしモードの 3 つを並べて表示

### ヘッダーボタン

#### 情報ボタン

- イベント名、イベント情報
- UUID
- 出席登録 URL
- 各種設定状況

<!-- 画像: 情報モーダル -->

![情報モーダル](./images/info_modal.png)

> **挿入する画像**: 情報モーダルウィンドウ。イベント詳細と設定状況が表示されている画面

#### ダウンロードボタン

- Excel、CSV、JSON 形式でエクスポート
- クライアント側と同じ機能

<!-- 画像: ダウンロードモーダル -->

![ダウンロードモーダル](./images/download_modal.png)

> **挿入する画像**: ダウンロードモーダル。3 つの形式（Excel、CSV、JSON）のボタンが表示されている画面

#### 出席登録ページボタン

- 新しいウィンドウで出席登録ページを開く

---

## データのエクスポート・インポート

### データのエクスポート

#### エクスポート可能な場所

1. **モニターページ**: 右上「ダウンロード」ボタン
2. **出席登録ページ**: 右上メニュー内「ダウンロード」

#### エクスポート形式

##### Excel 形式（.xlsx）

**シート構成**:

- **出席者リスト**: 学籍番号と出席状況
- **当日参加者**: 当日参加者の学籍番号
- **統計情報**: 出席者数、出席率、当日参加者数、合計数

**用途**: 印刷、集計、報告書作成

##### CSV 形式（.csv）

**特徴**:

- UTF-8（BOM 付き）で Excel で直接開ける
- カテゴリ列で「事前登録」「当日参加」を区別
- すべての参加者が 1 つのファイルに統合

**用途**: データベースへのインポート、他システムとの連携

##### JSON 形式（.json）

**含まれる情報**:

```json
{
  "eventname": "イベント名",
  "eventinfo": "イベント情報",
  "participants": [
    { "id": "学籍番号", "attended": true },
    ...
  ],
  "todaylist": ["当日参加者1", ...],
  "arrowtoday": true,
  "autotodayregister": false,
  "soukai": false,
  "nolist": false
}
```

**用途**: データのバックアップ、イベントの再利用

<!-- 画像: エクスポートされた各種ファイル -->

![エクスポートファイル](./images/exported_files.png)

> **挿入する画像**: Excel、CSV、JSON の 3 つのファイルアイコンまたはファイルエクスプローラーのスクリーンショット

### データのインポート

#### JSON ファイルからのインポート

##### ステップ 1: インポートページを開く

ホーム画面で「ファイルからインポート」をクリック

<!-- 画像: インポートページ（アップロード画面） -->

![インポートページ](./images/import_page.png)

> **挿入する画像**: JSON ファイルのドロップゾーンが表示されているインポートページ

##### ステップ 2: JSON ファイルを選択

- ファイルをドラッグ&ドロップ
- またはクリックしてファイル選択

##### ステップ 3: プレビューで確認

インポートしたデータが表示されます：

- **イベント情報**: イベント名、イベント情報
- **参加者数**: 事前登録者の人数
- **設定**: 各種設定の状況
- **参加者リスト**: 最初の 10 名を表示（出席済みは ✓ マーク付き）
- **当日参加者**: 当日参加者リスト（ある場合）

<!-- 画像: インポートプレビュー画面 -->

![インポートプレビュー](./images/import_preview.png)

> **挿入する画像**: JSON ファイル読み込み後のプレビュー画面。イベント情報、参加者リスト、当日参加者が表示されている画面

##### ステップ 4: オプションの選択

**当日参加者リストを含める**

- ✅ **チェック ON**: 当日参加者リストと出席情報を復元
- ❌ **チェック OFF**: 参加者リストのみ使用（出席情報はリセット）

⚠️ このチェックボックスは、JSON ファイルに当日参加者データがある場合のみ表示されます。

##### ステップ 5: イベントを登録

1. 「イベントを登録」ボタンをクリック
2. サーバーが起動（未起動の場合）
3. 登録完了メッセージが表示される
4. 自動的にモニターページへ遷移

<!-- 画像: インポート登録中の画面 -->

![インポート登録中](./images/import_registering.png)

> **挿入する画像**: 「登録中...」のローディング表示と、その後の「登録完了！」メッセージが表示されている画面

#### 使用例

**シナリオ 1: 定期イベントの再利用**

1. 前回のイベントデータを JSON 形式でエクスポート
2. 新しいイベントでインポート
3. イベント情報のみ更新して使用

**シナリオ 2: データのバックアップと復元**

1. イベント終了時に JSON 形式でエクスポート
2. 必要に応じて復元してデータを確認

**シナリオ 3: 複数イベントの管理**

1. 各イベントを JSON 形式で保存
2. 必要なときにインポートして切り替え

---

## トラブルシューティング

### よくある問題と解決方法

#### 1. 出席登録ページに接続できない

**症状**: ブラウザで出席登録ページが開かない

**原因と解決**:

- ✅ サーバーとクライアントが同じネットワークに接続されているか確認
- ✅ ファイアウォールがポート 50080、​50345 をブロックしていないか確認
- ✅ デスクトップアプリが起動しているか確認
- ✅ URL が正しいか確認（IP アドレス、UUID）

#### 2. 「切断」と表示される

**症状**: 出席登録ページの接続状態が「切断」

**原因と解決**:

- ✅ デスクトップアプリが起動しているか確認
- ✅ ネットワーク接続を確認
- ✅ ページを再読み込み（F5 キー）
- ✅ サーバー IP アドレスが変更されていないか確認

#### 3. 学籍番号が登録できない

**症状**: 学籍番号を入力してもエラーになる

**原因と解決**:

- ✅ 「当日参加を許可」が OFF の場合、事前登録されていない学籍番号は登録不可
- ✅ 「自動で当日参加登録」が OFF の場合、事前登録にない学籍番号は拒否される
- ✅ 学籍番号の入力形式が正しいか確認（スペースや記号）
- ✅ すでに登録済みでないか確認

#### 4. データが同期されない

**症状**: 複数のクライアントでデータが一致しない

**原因と解決**:

- ✅ すべてのクライアントが同じ UUID のイベントに接続しているか確認
- ✅ 接続状態が「接続済み」になっているか確認
- ✅ ページを再読み込み

#### 5. JSON インポートが失敗する

**症状**: JSON ファイルをインポートしてもエラーになる

**原因と解決**:

- ✅ JSON ファイルの形式が正しいか確認
- ✅ 必須フィールド（eventname、participants）が含まれているか確認
- ✅ ファイルが破損していないか確認（テキストエディタで開けるか）
- ✅ 他のシステムで編集した JSON の場合、このシステムでエクスポートしたものか確認

#### 6. Excel インポートが失敗する

**症状**: Excel ファイルをインポートしてもエラーになる

**原因と解決**:

- ✅ A 列に学籍番号が記載されているか確認
- ✅ 1 行目が学籍番号（ヘッダー行がない）または 2 行目から学籍番号が始まるか確認
- ✅ ファイル形式が`.xlsx`か確認（`.xls`は非対応）
- ✅ 空白行や不正な文字が含まれていないか確認

#### 7. モニターページに遷移できない

**症状**: インポート後にモニターページが表示されない

**原因と解決**:

- ✅ サーバーの起動を待つ（最大 15 秒）
- ✅ コンソールログを確認（エラーメッセージ）
- ✅ ブラウザの URL バーを確認（正しい UUID か）
- ✅ 手動でモニターページを開く：ホーム画面 → イベント一覧から選択

#### 8. ダウンロードしたファイルが開けない

**症状**: エクスポートした Excel/CSV ファイルが開けない

**原因と解決**:

- ✅ 対応するアプリケーションがインストールされているか確認
  - Excel: Microsoft Excel、LibreOffice Calc 等
  - CSV: Excel、テキストエディタ等
- ✅ ファイル拡張子が正しいか確認
- ✅ ダウンロードが完了しているか確認（ファイルサイズ）

---

## ネットワーク設定

### IP アドレスの確認方法

#### Windows

1. コマンドプロンプトを開く
2. `ipconfig`を実行
3. 「IPv4 アドレス」を確認

#### Mac

1. システム環境設定 → ネットワーク
2. 使用中の接続を選択
3. IP アドレスを確認

#### Linux

1. ターミナルを開く
2. `ip addr`または`ifconfig`を実行
3. IP アドレスを確認

### ポート設定

このシステムは以下のポートを使用します：

- **50080**: HTTP サーバー（出席登録ページ）
- **50345**: Socket.IO サーバー（リアルタイム通信）

ファイアウォールでこれらのポートを許可する必要があります。

---

## データ形式の詳細

### JSON 形式の仕様

```json
{
  "eventname": "string（必須）",
  "eventinfo": "string（オプション）",
  "participants": [
    {
      "id": "string（学籍番号）",
      "attended": boolean
    }
  ],
  "todaylist": ["string（学籍番号）", ...],
  "arrowtoday": boolean,
  "autotodayregister": boolean,
  "soukai": boolean,
  "nolist": boolean
}
```

### CSV 形式の仕様

| 列名     | 型     | 説明                      |
| -------- | ------ | ------------------------- |
| 学籍番号 | string | 参加者の学籍番号          |
| 出席     | string | "O" = 出席、空白 = 未出席 |
| カテゴリ | string | "事前登録" or "当日参加"  |

### Excel 形式の仕様

**シート 1: 出席者リスト**
| 列名 | 型 | 説明 |
|------|-----|------|
| 学籍番号 | string | 事前登録者の学籍番号 |
| 出席 | string | "O" = 出席、空白 = 未出席 |

**シート 2: 当日参加者**
| 列名 | 型 | 説明 |
|------|-----|------|
| 学籍番号 | string | 当日参加者の学籍番号 |

**シート 3: 統計情報**
| 項目 | 値 |
|------|-----|
| 出席者数 | 数値 |
| 出席率 | パーセンテージ |
| 当日参加者数 | 数値 |
| 合計数 | 数値 |

---

## セキュリティに関する注意事項

### データの保護

- ✅ データはローカルに保存されます（外部送信なし）
- ✅ ネットワークは同一 LAN 内のみ
- ⚠️ 公衆 Wi-Fi での使用は推奨しません
- ⚠️ 重要なデータは定期的にエクスポートしてバックアップ

### アクセス制御

- ⚠️ UUID を知っている人は誰でもアクセス可能
- ⚠️ パスワード認証機能はありません
- ✅ イベント終了後はアプリケーションを終了することを推奨

---

## よくある質問（FAQ）

### Q1: 複数のイベントを同時に管理できますか？

A: 現在、1 つのアプリケーションインスタンスで管理できるのは 1 つのイベントのみです。複数のイベントを管理する場合は、JSON ファイルでエクスポート・インポートして切り替えてください。

### Q2: インターネット接続は必要ですか？

A: 必要ありません。同一ネットワーク（LAN）内で動作します。

### Q3: 何人まで同時接続できますか？

A: 技術的な制限はありませんが、数百人規模での使用を想定しています。

### Q4: スマートフォンから出席登録できますか？

A: はい。ブラウザがあれば、スマートフォンやタブレットからも出席登録できます。

### Q5: データはどこに保存されますか？

A: アプリケーション実行中はメモリ内に保存されます。永続化するには JSON 形式でエクスポートしてください。

### Q6: 出席を取り消すことはできますか？

A: 現在、出席登録の取り消し機能は実装されていません。誤って登録した場合は、エクスポートしたデータを手動で編集するか、イベントを作り直してください。

### Q7: イベント終了後、データはどうなりますか？

A: アプリケーションを終了するとデータは消去されます。必ずエクスポートしてください。

### Q8: 出席登録 URL を共有する方法は？

A: モニターページまたは出席登録ページの情報モーダルから URL をコピーして、メール、チャット等で共有してください。

---

## サポート情報

### システム要件

- **OS**: Windows 10/11、macOS 10.15 以降、Linux
- **メモリ**: 最小 2GB RAM
- **ストレージ**: 100MB 以上の空き容量
- **ネットワーク**: LAN 接続

### バージョン情報

- **アプリケーション**: v1.0.0
- **フレームワーク**: Tauri 2.0
- **ビルド日**: [日付]

---

## 付録

### キーボードショートカット

#### 出席登録ページ

- `Enter`: 学籍番号を登録
- `Esc`: 入力フィールドをクリア

### 開発者向け情報

#### 技術スタック

- **フロントエンド**: React + TypeScript + Vite
- **バックエンド**: Rust (Tauri)
- **サーバー**: Axum (HTTP) + Socketioxide (WebSocket)
- **スタイリング**: Tailwind CSS
- **アニメーション**: Framer Motion

#### ポート番号

- **50080**: HTTP（静的ファイル配信）
- **50345**: Socket.IO（リアルタイム通信）

---

## 更新履歴

### v1.0.0（初版）

- 初回リリース
- 基本的な出席管理機能
- Excel/CSV/JSON エクスポート機能
- JSON インポート機能
- リアルタイム同期機能
- 当日参加者管理機能
- 複数設定モード（総会、リストなし等）

---

## ライセンス

[ライセンス情報を記載]

---

## お問い合わせ

[お問い合わせ先を記載]

---

**© 2025 出席管理システム. All rights reserved.**
